(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;w=window.tu={},l=function(a,b,c){var d,e,f;return f=a+":",d=document.createElement("test"),e=d.style,e.cssText=c?f+b:f+["-webkit-","-moz-","-ms-","-o-",""].join(b+";"+f)+b+";",-1!==e[a].indexOf(b)},s=function(a){var b;return null==a&&(a=!1),b=w.navHeight,w.navHeight=$(".app-message").length&&$("body").hasClass("app-message-visible")?$(".app-message").outerHeight(!0)+$(".app-message").offset().top:$(".navbar").outerHeight(!0),a&&b!==w.navHeight?q():void 0},q=function(){return $(".container").css("padding-top",w.navHeight),$(".date-marker").css("top",w.navHeight+14)},b=function(a){var b,c,d;return c="open"===a?"280px":"0",d=".navbar-default",$(".app-message").length&&$("body").hasClass("app-message-visible")&&(d+=", .app-message"),$(d).animate({left:c},150,function(){return"0"===c?$(d).css("left",""):void 0}),$(".date-marker.fixed").length&&(b=$(".date-marker.fixed").offset().left,c="open"===a?""+(b+280)+"px":""+(b-280)+"px",$(".date-marker.fixed").animate({left:c},150,function(){return $(".date-marker.fixed").css("left","")})),$(window).width()<=540?(c="open"===a?"-280px":"0",$(".btn-submit").animate({right:c},150)):void 0},w.appMessage={paddingChange:w.navHeight-$(".navbar-default").outerHeight(!0),create:function(a,b){var c,d;return null==b&&(b="info"),$(".app-message").text().trim()!==$("<div/>").html(a).text()?(w.appMessage.destroy(),d="content","warning"===b&&(d+=" fa-override-before fa-exclamation-triangle"),"success"===b&&(d+=" fa-override-before fa-check-circle"),c=$('<div class="app-message app-message-'+b+'" style="display: none">\n  <div class="'+d+'">'+a+'</div>\n  <a href="#" class="app-message-close"><i class="fa fa-times-circle icon"></i></a>\n</div>'),$("#page-content").append(c),$(".container").animate({paddingTop:"+="+w.appMessage.paddingChange},150,function(){return $(".app-message").fadeIn(150),$("body").addClass("app-message-visible"),$("body").hasClass("account")?void 0:s(!0)})):void 0},destroy:function(){var a;return a=$(".app-message"),a.fadeOut(150),$(".container").animate({paddingTop:"+=-"+w.appMessage.paddingChange},150,function(){return a.remove(),$("body").removeClass("app-message-visible"),$("body").hasClass("account")?void 0:s(!0)})}},k=window.tu.constants={},k.colors={pea:"#9dd767",pea_dark:"#5fac1c",pea_darker:"#417505",salmon:"#fc939e",salmon_dark:"#da6070",salmon_darker:"#d0374b",creamsicle:"#ffbb4e",creamsicle_dark:"#ff8f41",creamsicle_darker:"#f36400",sepia:"#c0bdaf",sepia_dark:"#a19f8b",sepia_darker:"#8a876f",historical:"#c0bdaf",historical_dark:"#a19f8b",historical_darker:"#8a876f",purple:"#b690e2",purple_dark:"#8e69c2",purple_darker:"#7348b0",mint:"#41dab3",mint_dark:"#24b98f",mint_darker:"#1c8e6e",bubblegum:"#f576b5",bubblegum_dark:"#b3487c",bubblegum_darker:"#8f3963",seabreeze:"#44c9d7",seabreeze_dark:"#198a9c",seabreeze_darker:"#126370",dijon:"#e4bf28",dijon_dark:"#c59301",dijon_darker:"#926d01",sandalwood:"#fd8560",sandalwood_dark:"#d13a0a",sandalwood_darker:"#a02c08",caramel:"#dd814b",caramel_dark:"#9e5e14",caramel_darker:"#71430e"},r=function(a,b){return null==a&&(a=!1),null==b&&(b=!1),$(".body-list-show-some").each(function(){var c,d,e;return c=$(this),a&&(c.height(c.height()),c.data("height-closed",c.outerHeight(!0)),c.find(".list-item").show()),null!=c.data("rows")&&null!=c.data("row-height")?(e=c.data("row-padding")?c.data("row-padding"):0,d=c.data("rows")*c.data("row-height")+(c.data("rows")-1)*e):(d=0,c.find(".list-item").each(function(){return d+=$(this).outerHeight(!0)})),c.data("height-open",d),b&&c.hasClass("all-items-visible")?c.height(d):void 0})},p=function(){return $(".date-group").each(function(){return $(this).data("scroll-top",$(this).offset().top),$(this).data("scroll-bottom",$(this).offset().top+$(this).height()-$(this).find(".date-marker").height())})},a=null,o=function(){var b;return $(window).scrollTop()+$(window).height()<=$("body").height()&&(b=!1,$(".date-group").each(function(){var c;return $(this).offset().top<(c=$(window).scrollTop()+w.navHeight)&&c<$(this).data("scroll-bottom")-14?(b=!0,null==a&&(a=$(this)),n($(this)),null==a||$(this).is(a)?void 0:a=$(this)):$(this).find(".date-marker").removeClass("fixed absolute").css("top","")}),null!=a&&!b)?(a.data("scroll-top")<$(window).scrollTop()&&n(a,"absolute"),n(a.prev(),"absolute",!1)):void 0},n=function(a,b,c){var d;return null==b&&(b="fixed"),null==c&&(c=!0),c&&$(".date-marker").removeClass("fixed absolute").css("top",""),d=a.find(".date-marker"),d.addClass(b),"absolute"===b?d.css("top",a.data("scroll-bottom")):void 0},v=null,j=function(a){return""!==a.val()?(v&&clearTimeout(v),v=setTimeout(function(){var b,c;return b=a.parent(),1!==(null!=(c=a.val().match(/^[\w]{3,15}$/gi))?c.length:void 0)?(b.removeClass("form-group-ok").addClass("form-group-warning"),w.appMessage.create("Your username must be between 3 - 15 unaccented numbers or letters.","warning")):$.getJSON("user/check.php?un="+encodeURIComponent(a.val()),function(a){return a.available?(b.addClass("form-group-ok").removeClass("form-group-warning"),b.find(".help-block").remove(),w.appMessage.destroy()):(b.removeClass("form-group-ok").addClass("form-group-warning"),w.appMessage.create("Sorry, someone already grabbed that name. Please try again.","warning"))})},500)):void 0},c=function(a,b){var c;return c=!1,null!=a&&""!==a?$.getJSON("user/check-email.php?em="+encodeURIComponent(a),function(a){return a.available&&(c=!0),b(c)}):b(c)},g=function(a){return null!=a.match(/^(?=.*[0-9]+.*)(?=.*[a-zA-Z]+.*).{8,}$/gi)},e=function(a){return null!=a.match(/^([a-z0-9_\.\+-]+)@([\da-z\.-]+)\.([a-z\.]{2,8})$/)},u=null,f=function(a){return""!==a.val()?(u&&clearTimeout(u),u=setTimeout(function(){var b;return b=a.parent(),g(a.val())?(b.addClass("form-group-ok").removeClass("form-group-warning"),b.find(".help-block").remove(),w.appMessage.destroy()):(b.removeClass("form-group-ok").addClass("form-group-warning"),w.appMessage.create("Your password must be at least 8 characters and contain both numbers &amp; letters.","warning"))},500)):void 0},h=function(a,b){if(a.find("#control-password-new, #control-password-verify").parent().removeClass("form-group-warning"),w.appMessage.destroy(),a.find("#control-password-current").length&&0!==a.find("#control-password-current").val().length){if(0===a.find("#control-password-new").val().length&&0===a.find("#control-password-verify").val().length)return w.appMessage.create("You didn't provide a new password in both fields.","warning"),a.find("#control-password-new, #control-password-verify").parent().addClass("form-group-warning"),b.preventDefault();if(!g(a.find("#control-password-new").val()))return w.appMessage.create("Your password must be at least 8 characters, contain both numbers &amp; letters, and omit special characters.","warning"),a.find("#control-password-new").parent().addClass("form-group-warning"),b.preventDefault();if(a.find("#control-password-new").val()!==a.find("#control-password-verify").val())return b.preventDefault(),w.appMessage.create("The passwords must match.","warning"),a.find("#control-password-new, #control-password-verify").parent().addClass("form-group-warning")}},t=null,d=function(a){var b;return b=a.val(),""!==a.val()?(t&&clearTimeout(t),t=setTimeout(function(){var b;return b=a.parent(),e(a.val())?c(a.val(),function(a){return a?(b.addClass("form-group-ok").removeClass("form-group-warning"),b.find(".help-block").remove(),w.appMessage.destroy()):(b.removeClass("form-group-ok").addClass("form-group-warning"),w.appMessage.create("An existing account is using this email address.","warning"))}):(b.removeClass("form-group-ok").addClass("form-group-warning"),w.appMessage.create("Please enter a valid email address.","warning"))},500)):void 0},i=function(a){return a.is(":checked")?(a.parent().next(".help-block").remove(),"Please review and agree to the terms of service."===$(".app-message").text().trim()?w.appMessage.destroy():void 0):w.appMessage.create("Please review and agree to the terms of service.","warning")},m=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++){if(b=a[c],""===b.val()||b.parent().hasClass("form-group-warning")){b.focus();break}e.push(void 0)}return e},$(function(){var a,c;return r(!0),$(window).load(function(){return p()}),s(),a=!1,c=$.jPanelMenu({openPosition:"280px",keyboardShortcuts:!1,beforeOpen:function(){return b("open")},beforeClose:function(){return b("close")},afterOff:function(){return $(".app-message, .navbar-default").stop(!0,!0).css("left","")}}),$("body").hasClass("menu-open")&&!($(window).width()<820)||$("body").hasClass("menu-off")||($("#page-content").css({minHeight:$(window).height()-w.navHeight}),c.on(),a=!0),$(window).resize(function(){return r(!1,!0),s(!0),!$("body").hasClass("menu-off")&&$("body").hasClass("menu-open")&&$(window).width()<820&&!a&&(c.on(),a=!0),!$("body").hasClass("menu-off")&&$("body").hasClass("menu-open")&&$(window).width()>=820&&a?(c.off(),a=!1):void 0}),$("body").hasClass("insight-stream")&&(l("position","sticky")?$(".date-marker").addClass("sticky"):$(window).scroll(function(){return o()})),$("body").on("click",".share-button-open",function(a){var b,c;return a.preventDefault(),b=$(this).parent(),b.toggleClass("open"),c=b.parent().outerWidth(!0)-b.outerWidth(!0)+4,b.animate({right:c},250)}),$("body").on("click",".share-button-close",function(a){var b;return a.preventDefault(),b=$(this).parent(),b.toggleClass("open"),b.animate({right:"-275px"},250)}),$("body").on("click",".panel-body .btn-see-all",function(){var a,b,c;return a=$(this),b=a.prev(".body-list"),c=b.data(b.hasClass("all-items-visible")?"height-closed":"height-open"),b.animate({height:c},250,function(){var c;return c=a.find(".btn-text").text(),a.find(".btn-text").text(a.data("text")),a.data("text",c),b.toggleClass("all-items-visible"),a.toggleClass("active")})}),$(window).load(function(){return $("body").data("app-message-text")&&w.appMessage.create($("body").data("app-message-text"),$("body").data("app-message-type")),"undefined"!=typeof app_message&&null!==app_message&&null!=app_message.msg&&null!=app_message.type?w.appMessage.create(app_message.msg,app_message.type):void 0}),$("body").on("click","#msg-action",function(a){var b;return a.preventDefault(),b=$(this),null!=b.data("submit-target")?$(b.data("submit-target")).find(".btn-submit").click():void 0}),$("body").on("click",".app-message .app-message-close",function(a){return a.preventDefault(),w.appMessage.destroy()}),$("#form-register").length&&(m([$("#email"),$("#username"),$("#pwd")]),$("#username, #pwd, #email").on("blur",function(){return $(this).val().length?$(this).data("do-validate","1").keyup():void 0}),$("#username").on("keyup",function(){return"1"===$(this).data("do-validate")?j($(this)):void 0}),$("#pwd").on("keyup",function(){return"1"===$(this).data("do-validate")?f($(this)):void 0}),$("#email").on("keyup",function(){return"1"===$(this).data("do-validate")?d($(this)):void 0}),$("#terms").on("click",function(){return"1"===$(this).data("do-validate")?i($(this)):void 0})),$("#form-reset").on("submit",function(a){return 0===$(this).find("#password").val().length||0===$(this).find("#password_confirm").val().length?(w.appMessage.create("You must fill in both fields","warning"),a.preventDefault()):g($(this).find("#password").val())?$(this).find("#password").val()!==$(this).find("#password_confirm").val()?(a.preventDefault(),w.appMessage.create("Passwords must match","warning")):w.appMessage.destroy():(w.appMessage.create("Your password must be at least 8 characters, contain both numbers &amp; letters, and omit special characters.","warning"),a.preventDefault())}),$("#form-settings").on("submit",function(a){return h($(this),a)}),$("body").on("click",".show-section",function(a){var b;return b=$($(this).data("section-selector")),b.length&&(a.preventDefault(),b.length)?b.show():void 0})})}).call(this);